<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="doc-style.css" />
  <script src="doc-filelist.js"></script>
  <script>
    var relativeDir = "";
    var thisFile = "README.md";
    var defaultSidebar = true;
  </script>
  <script src="doc-script.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0" /></head>
<body>
  <nav>
<div class="logo"><a href="http://alinex.github.io"
  onmouseover="logo.src='https://alinex.github.io/images/Alinex-200.png'"
  onmouseout="logo.src='https://alinex.github.io/images/Alinex-black-200.png'">
  <img name="logo" src="https://alinex.github.io/images/Alinex-black-200.png"
    width="150" title="Alinex Universe Homepage" />
  </a>
  <img src="http://alinex.github.io/images/Alinex-200.png"
    style="display:none" alt="preloading" />
</div>
<div class="links">
  <a href="http://alinex.github.io/blog"
    class="btn btn-primary"><span class="glyphicon-pencil"></span> Blog</a>
  <a href="http://alinex.github.io/develop"
    class="btn btn-primary"><span class="glyphicon-book"></span> Develop</a>
  <a href="http://alinex.github.io/code.html"
    class="btn btn-warning"><span class="glyphicon-cog"></span> Code</a>
</div>
</nav><div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#package-alinex-mail">Package: alinex-mail</a>
      </div>

      <div class="heading h2">
        <a href="#install">Install</a>
      </div>

      <div class="heading h2">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h2">
        <a href="#configuration">Configuration</a>
      </div>

      <div class="heading h3">
        <a href="#email-templates">Email Templates</a>
      </div>

      <div class="heading h4">
        <a href="#transport">Transport</a>
      </div>

      <div class="heading h4">
        <a href="#addressing">Addressing</a>
      </div>

      <div class="heading h4">
        <a href="#content">Content</a>
      </div>

      <div class="heading h2">
        <a href="#license">License</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container" tabindex="0"><a id="fork" href="https://github.com/alinex/node-mail" title="Fork me on GitHub"></a>
    <div class="docs markdown"><div class="pilwrap" id="package-alinex-mail">
  <h1>
    <a href="#package-alinex-mail" name="package-alinex-mail" class="pilcrow"></a>
Package: alinex-mail
  </h1>
</div>
<p><a href="https://travis-ci.org/alinex/node-mail"><img src="https://travis-ci.org/alinex/node-mail.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/r/alinex/node-mail?branch=master"><img src="https://coveralls.io/repos/alinex/node-mail/badge.png?branch=master" alt="Coverage Status"></a>
<a href="https://gemnasium.com/alinex/node-mail"><img src="https://gemnasium.com/alinex/node-mail.png" alt="Dependency Status"></a></p>
<p>An easy to use module for sending mails.</p>
<ul>
<li>fully configurable</li>
<li>configuration templates</li>
<li>using markdown with auto text/html creation</li>
<li>support for handlebars templates</li>
</ul>
<p>While sending mails it will also transform inline images in html into cid images
attached to the mail to make it more standard conform.</p>
<blockquote>
<p>It is one of the modules of the <a href="http://alinex.github.io/code.html">Alinex Universe</a>
following the code standards defined in the <a href="http://alinex.github.io/develop">General Docs</a>.</p>
</blockquote>
<div class="pilwrap" id="install">
  <h2>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h2>
</div>
<p><a href="https://www.npmjs.com/package/alinex-mail"><img src="https://nodei.co/npm/alinex-mail.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="NPM">
<img src="https://nodei.co/npm-dl/alinex-mail.png?months=9&amp;height=3" alt="Downloads">
</a></p>
<p>The easiest way is to let npm add the module directly to your modules
(from within you node modules directory):</p>
<pre><code class="sh">npm install alinex-mail --save
</code></pre>
<p>And update it to the latest version later:</p>
<pre><code class="sh">npm update alinex-mail --save
</code></pre>
<p>This package will install a lot of subpackages to ensure the full functionality
but only the ones really needed are loaded on demand.</p>
<p>Always have a look at the latest <a href="Changelog.md.html">changes</a>.</p>
<div class="pilwrap" id="usage">
  <h2>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h2>
</div>
<p>The first step is to load the module:</p>
<pre><code class="coffee">mail = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-mail'</span>
</code></pre>
<p>And now you simply send your mails:</p>
<pre><code class="coffee">mail.send
  base: <span class="hljs-string">'default'</span>
  subject: <span class="hljs-string">'Test'</span>
, context, <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
  <span class="hljs-comment"># handling of errors or success</span>
</code></pre>
<p>The above setup is all you may need to send an email. All the missing information
is taken from it's base. Which is like always defined as a configuration setting.</p>
<p>The context is optional and only used if the mail's body contains handlebars
templates.</p>
<p>If you want to validate email settings within you applications configuration, you
may use the schema from this package:</p>
<pre><code class="coffee">emailSchema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'alinex-mail/lib/configSchema'</span>).email
</code></pre>
<p>You may also resolve the email templates before sending it:</p>
<pre><code class="coffee">setup = mail.resolve setup
</code></pre>
<div class="pilwrap" id="configuration">
  <h2>
    <a href="#configuration" name="configuration" class="pilcrow"></a>
Configuration
  </h2>
</div>
<p>The configuration is based on multiple email templates.</p>
<div class="pilwrap" id="email-templates">
  <h3>
    <a href="#email-templates" name="email-templates" class="pilcrow"></a>
Email Templates
  </h3>
</div>
<p>They will be defined under <code>/email</code>:</p>
<pre><code class="yaml"><span class="hljs-comment"># Email Templates</span>
<span class="hljs-comment"># =================================================</span>


<span class="hljs-comment"># Default Email Templates</span>
<span class="hljs-comment"># -------------------------------------------------</span>
<span class="hljs-comment"># This will extend/overwrite the already existing setup within the code.</span>
<span class="hljs-attr">default:</span>
  <span class="hljs-comment"># specify how to connect to the server</span>
<span class="hljs-attr">  transport:</span> smtp://alexander.schilling%<span class="hljs-number">40</span>mycompany.de:&lt;PASSWORD&gt;@mail.mycompany.de
  <span class="hljs-comment"># specify retries</span>
<span class="hljs-attr">  retry:</span>
<span class="hljs-attr">    times:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># makes 2 tries at max</span>
<span class="hljs-attr">    interval:</span> <span class="hljs-number">5</span>s
  <span class="hljs-comment"># sender address</span>
<span class="hljs-attr">  from:</span> alexander.schilling@mycompany.de
<span class="hljs-attr">  replyTo:</span> somebody@mycompany.de

  <span class="hljs-comment"># content</span>
<span class="hljs-attr">  locale:</span> en
<span class="hljs-attr">  subject:</span> <span class="hljs-string">&gt;
    Database Report: <span class="hljs-template-variable">{{name}}</span>
</span><span class="hljs-attr">  body:</span> |+
    {{conf.title}}
    ==========================================================================

    {{conf.description}}

    Started at {{dateFormat date <span class="hljs-string">"LLL"</span>}}:

    | Zeilen | Datei    | Beschreibung <span class="hljs-string">|
    | ------:| -------- | ------------ |
    <span class="hljs-template-variable">{{#each result}}</span>
    | <span class="hljs-template-variable">{{rows}}</span> | <span class="hljs-template-variable">{{file}}</span> | <span class="hljs-template-variable">{{description}}</span> |
    <span class="hljs-template-variable">{{/each}}</span>

    Find the files attached to your mail if data available!
</span></code></pre>
<p>To make it more modular you may also add a <code>base</code> setting to use the setting defined
there as a base and the options here may overwrite or enhance the base setup.</p>
<div class="pilwrap" id="transport">
  <h4>
    <a href="#transport" name="transport" class="pilcrow"></a>
Transport
  </h4>
</div>
<p>The transport setting defines how to send the email. This should specify the
connection for the mailserver to use for sending. It is possible to do this using
a connection url like above with the syntax:</p>
<pre><code>&lt;protocol&gt;://&lt;user&gt;:&lt;password&gt;@&lt;server&gt;:&lt;port&gt;
</code></pre>
<p>Or you may specify it as object like:</p>
<pre><code class="yaml"><span class="hljs-attr">transport:</span>
<span class="hljs-attr">  pool:</span> &lt;boolean&gt; <span class="hljs-comment"># use pooled connections defaults to false</span>
<span class="hljs-attr">  direct:</span> &lt;boolean&gt; <span class="hljs-comment"># set to true to try to connect directly to recipients MX</span>
<span class="hljs-attr">  service:</span> &lt;string&gt; <span class="hljs-comment"># name of well-known service (will set host, port and secure options)</span>
  <span class="hljs-comment"># services: 1und1, AOL, DebugMail.io, DynectEmail, FastMail, GandiMail, Gmail,</span>
  <span class="hljs-comment"># Godaddy, GodaddyAsia, GodaddyEurope, hot.ee, Hotmail, iCloud, mail.ee, Mail.ru,</span>
  <span class="hljs-comment"># Mailgun, Mailjet, Mandrill, Naver, Postmark, QQ, QQex, SendCloud, SendGrid,</span>
  <span class="hljs-comment"># SES, Sparkpost, Yahoo, Yandex, Zoho</span>
<span class="hljs-attr">  host:</span> &lt;string&gt; <span class="hljs-comment"># the hostname or IP address to connect to</span>
<span class="hljs-attr">  port:</span> &lt;integer&gt; <span class="hljs-comment"># the port to connect to (defaults to 25 or 465)</span>
<span class="hljs-attr">  secure:</span> &lt;boolean&gt; <span class="hljs-comment"># if true the connection will only use TLS else (the default)</span>
  <span class="hljs-comment"># TLS may still be upgraded to if available via the STARTTLS command</span>
<span class="hljs-attr">  ignoreTLS:</span> &lt;boolean&gt; <span class="hljs-comment"># if this is true and secure is false, TLS will not be used</span>
<span class="hljs-attr">  requireTLS:</span> &lt;boolean&gt; <span class="hljs-comment"># if this is true and secure is false, it uses STARTTLS</span>
  <span class="hljs-comment"># even if the server does not advertise support for it</span>
<span class="hljs-attr">  tls:</span> &lt;object&gt; <span class="hljs-comment"># additional socket options like `{rejectUnauthorized: true}`</span>
<span class="hljs-attr">  auth:</span> <span class="hljs-comment"># authentication objects</span>
<span class="hljs-attr">    user:</span> &lt;string&gt; <span class="hljs-comment"># the username</span>
<span class="hljs-attr">    pass:</span> &lt;string&gt; <span class="hljs-comment"># the password for the user</span>
<span class="hljs-attr">  authMethod:</span> &lt;string&gt; <span class="hljs-comment"># preferred authentication method, eg. ‘PLAIN’</span>
<span class="hljs-attr">  name:</span> &lt;string&gt; <span class="hljs-comment"># hostname of the client, used for identifying to the server</span>
<span class="hljs-attr">  localAddress:</span> &lt;string&gt; <span class="hljs-comment"># the local interface to bind to for network connections</span>
<span class="hljs-attr">  connectionTimeout:</span> &lt;integer&gt; <span class="hljs-comment"># milliseconds to wait for the connection to establish</span>
<span class="hljs-attr">  greetingTimeout:</span> &lt;integer&gt; <span class="hljs-comment"># milliseconds to wait for the greeting after connection is established</span>
<span class="hljs-attr">  socketTimeout:</span> &lt;integer&gt; <span class="hljs-comment"># milliseconds of inactivity to allow</span>
<span class="hljs-attr">  debug:</span> &lt;boolean&gt; <span class="hljs-comment"># set to true to log the complete SMTP traffic</span>
  <span class="hljs-comment"># if pool is set to true:</span>
<span class="hljs-attr">  maxConnections:</span> &lt;integer&gt; <span class="hljs-comment"># the count of maximum simultaneous connections (defaults to 5)</span>
<span class="hljs-attr">  maxMessages:</span> &lt;integer&gt; <span class="hljs-comment"># limits the message count to be sent using a single connection (defaults to 100)</span>
<span class="hljs-attr">  rateLimit:</span> &lt;integer&gt; <span class="hljs-comment"># limits the message count to be sent in a second (defaults to false)    </span>
</code></pre>
<div class="pilwrap" id="addressing">
  <h4>
    <a href="#addressing" name="addressing" class="pilcrow"></a>
Addressing
  </h4>
</div>
<p>First you can define the sender address using:</p>
<pre><code class="yaml"><span class="hljs-attr">from:</span> &lt;string&gt; <span class="hljs-comment"># the address used as sender(often the same as used in transport)</span>
<span class="hljs-attr">replyTo:</span> &lt;string&gt; <span class="hljs-comment"># address which should be used for replys</span>
</code></pre>
<p>And you give the addresses to send the mail to. In the following fields: <code>to</code>, <code>cc</code>
and <code>bcc</code> you may give a single address or a list of addresses to use.
All e-mail addresses can be plain e-mail addresses</p>
<pre><code>name@mymailserver.com
</code></pre>
<p>or with formatted name (includes unicode support)</p>
<pre><code>&quot;My Name&quot; &lt;name@mymailserver.com&gt;
</code></pre>
<div class="pilwrap" id="content">
  <h4>
    <a href="#content" name="content" class="pilcrow"></a>
Content
  </h4>
</div>
<p>The content of the mail consists of an subject line which should be not to long
and the body. The body is given as <a href="http://alinex.github.io/develop/lang/markdown.html">Markdown</a>
syntax and supports all possibilities from
<a href="http://alinex.github.io/node-report/README.md.html#markup%20syntax">report</a>.
This will be converted to a plain text and html version for sending so that the
mail client can choose the format to display.</p>
<p>You may also give the 'text' and 'html' content as property itself. But keep in
mind that within the base properties no markdown conversions are done. In the
'body' it will.</p>
<p>Like you see above, you can use handlebar syntax to use some variables from the
code. This is possible in subject and body. And you may specify a
locale to use for date formatting.</p>
<p>You can also define different templates which can be referenced from within the
job.</p>
<p>Find more examples at <a href="http://alinex.github.io/node-validator/README.md.html#handlebars">validator</a>.</p>
<div class="pilwrap" id="license">
  <h2>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h2>
</div>
<p>Copyright 2016 Alexander Schilling</p>
<p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<blockquote>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
</blockquote>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
</div>
  </div>
</body>
</html>
